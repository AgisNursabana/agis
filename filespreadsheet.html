



<!DOCTYPE html>
<html>
<head>

<style>
p {
font-size:40px;
font-family: calibri;
background-color: coral;
}
</style>
  <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>                                             
  <script type="text/javascript">
    google.charts.load('current', {'packages':['table']});
    google.charts.setOnLoadCallback(drawTable);

    function drawTable() {
      var query = new google.visualization.Query('https://docs.google.com/spreadsheets/d/1_2fne2lb4Zme0whLfBSuE2rZKK0Fn947mMlHjwtJJ_Y/gviz/tq?tq=SELECT%20*');                                                                                                      
      query.send(handleQueryResponse);
    }

    function handleQueryResponse(response) {
      if (response.isError()) {
        alert('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
        return;
      }
      var data = response.getDataTable();
      var table = new google.visualization.Table(document.getElementById('google-sheet-table'));
      table.draw(data, {showRowNumber: true, width: '100%', height: '100%'});

      if (data.getNumberOfRows() > 1 && data.getNumberOfColumns() > 14) {
        var valueO4 = data.getValue(1, 14);
        if (valueO4 !== null && valueO4 !== undefined) {
          var rupiah = valueO4.toLocaleString('id-ID', { style: 'currency', currency: 'IDR' });
          document.getElementById('nilai-O4').innerHTML = `<b style="font-size:30px">Total Fee : </b><b style="font-size: 40px;color:green;">${rupiah}</b>`;
        } else {
          document.getElementById('nilai-O4').innerHTML = 'Data tidak ada';
        }
      }
    }

    setInterval(drawTable, 60000);
  </script>
</head>
<body>
  <p>FEE ETY KURNIAWAN</p>
  <div id="google-sheet-table"></div>
  <div id="nilai-O4"></div>
</body>
</html>
